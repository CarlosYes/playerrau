<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Radio Globalmix - XAT Player</title>
    <style>
        :root { --accent: #00f2ff; --bg: #0a0a0a; }
        body { background: transparent; margin: 0; font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; color: #fff; overflow: hidden; }
        .player-container { width: 680px; background: var(--bg); border-radius: 4px; padding: 20px; display: grid; grid-template-columns: 220px 1fr; gap: 20px; position: relative; border: 1px solid #222; box-shadow: 0 20px 50px rgba(0,0,0,0.9); }
        .top-banner { grid-column: 1 / -1; background: #000; padding: 8px; font-size: 11px; display: flex; justify-content: space-between; border-bottom: 2px solid var(--accent); color: #666; font-weight: bold; }
        #album-art { width: 220px; height: 220px; background: #000; border-radius: 4px; object-fit: cover; }
        .stats-info { font-size: 11px; line-height: 1.6; color: #555; margin-top: 10px; }
        .stats-info b { color: #aaa; }
        .side-right { display: flex; flex-direction: column; justify-content: space-between; }
        .track-display h2 { font-size: 18px; margin: 0; color: #fff; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .track-display p { font-size: 15px; margin: 5px 0 10px; color: var(--accent); font-weight: bold; }
        .eq-box { background: #000; height: 90px; border-radius: 4px; display: flex; align-items: center; justify-content: center; }
        #visualizer { width: 100%; height: 70px; }
        .time-now { font-size: 36px; font-weight: bold; text-align: center; color: #fff; margin: 10px 0; }
        .footer { grid-column: 1 / -1; display: flex; align-items: center; gap: 20px; border-top: 1px solid #222; padding-top: 15px; }
        .play-btn { width: 60px; height: 60px; border-radius: 50%; border: 3px solid #333; background: none; color: #fff; font-size: 24px; cursor: pointer; transition: 0.3s; }
        .play-btn:hover { border-color: var(--accent); color: var(--accent); }
        .vol-control { flex-grow: 1; display: flex; align-items: center; gap: 10px; font-size: 11px; color: #666; }
        input[type=range] { flex-grow: 1; accent-color: var(--accent); cursor: pointer; }
        .side-colors { position: absolute; right: -40px; top: 50%; transform: translateY(-50%); display: flex; flex-direction: column; gap: 10px; }
        .dot { width: 18px; height: 18px; border-radius: 50%; cursor: pointer; border: 2px solid #333; }
    </style>
</head>
<body>

<div class="player-container">
    <div class="top-banner">
        <span>GLOBALMIX ONLINE</span>
        <span id="b-track">CARREGANDO...</span>
    </div>
    <div class="side-left">
        <img id="album-art" src="https://via.placeholder.com/220?text=RADIO" alt="Capa">
        <div class="stats-info">
            OUVINTES: <b id="val-listeners">0</b><br>
            G√äNERO: <b id="val-genre">V√ÅRIOS</b><br>
            BITRATE: <b id="val-bitrate">128</b> KBPS
        </div>
    </div>
    <div class="side-right">
        <div class="track-display">
            <h2 id="song-title">Sintonizando...</h2>
            <p id="artist-name">Radio Globalmix</p>
        </div>
        <div class="eq-box"><canvas id="visualizer"></canvas></div>
        <div class="time-now" id="clock">00:00:00</div>
    </div>
    <div class="footer">
        <button class="play-btn" id="playBtn">‚ñ∂</button>
        <div class="vol-control">
            VOL üîä <input type="range" id="volRange" min="0" max="1" step="0.01" value="0.8"> <span id="volPerc">80%</span>
        </div>
    </div>
    <div class="side-colors">
        <div class="dot" style="background: #00f2ff;" onclick="setTheme('#00f2ff')"></div>
        <div class="dot" style="background: #ff4d4d;" onclick="setTheme('#ff4d4d')"></div>
        <div class="dot" style="background: #a2ff00;" onclick="setTheme('#a2ff00')"></div>
        <div class="dot" style="background: #ffec00;" onclick="setTheme('#ffec00')"></div>
    </div>
</div>

<script>
    const _sU = "https://sp0.redeaudio.com:10822/;type=mp3";
    const _statsURL = "https://sp0.redeaudio.com:10822/7.html";
    const _itunes = "https://itunes.apple.com/search?term=";

    const audio = new Audio(_sU);
    audio.crossOrigin = "anonymous";
    const canvas = document.getElementById('visualizer');
    const ctx = canvas.getContext('2d');
    let audioCtx, analyser, dataArray;

    function setTheme(c) { document.documentElement.style.setProperty('--accent', c); }

    setInterval(() => { document.getElementById('clock').innerText = new Date().toLocaleTimeString(); }, 1000);

    async function updateMetadata() {
        const proxy = "https://api.allorigins.win/get?url=";
        try {
            const response = await fetch(proxy + encodeURIComponent(_statsURL));
            const data = await response.json();
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = data.contents;
            const raw = tempDiv.innerText.split(',');

            if (raw.length >= 6) {
                const ouvintes = raw[0];
                const bitrate = raw[5];
                const musica = raw[6];

                document.getElementById('val-listeners').innerText = ouvintes;
                document.getElementById('val-bitrate').innerText = bitrate;
                document.getElementById('b-track').innerText = musica;

                const partes = musica.split(' - ');
                document.getElementById('artist-name').innerText = partes[0] || "Globalmix";
                document.getElementById('song-title').innerText = partes[1] || partes[0];

                fetchCover(musica);
            }
        } catch (e) {}
    }

    async function fetchCover(t) {
        try {
            const res = await fetch(_itunes + encodeURIComponent(t) + "&limit=1");
            const j = await res.json();
            if(j.results && j.results[0]) {
                document.getElementById('album-art').src = j.results[0].artworkUrl100.replace('100x100', '600x600');
            }
        } catch (err) {}
    }

    function initVisualizer() {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        analyser = audioCtx.createAnalyser();
        const source = audioCtx.createMediaElementSource(audio);
        source.connect(analyser);
        analyser.connect(audioCtx.destination);
        analyser.fftSize = 128;
        dataArray = new Uint8Array(analyser.frequencyBinCount);
        render();
    }

    function render() {
        requestAnimationFrame(render);
        analyser.getByteFrequencyData(dataArray);
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        let x = 0;
        const midY = canvas.height / 2;
        for (let i = 0; i < dataArray.length; i++) {
            const h = (dataArray[i] / 255) * midY;
            ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--accent');
            ctx.fillRect(x, midY - h, 3, h * 2);
            x += 7;
        }
    }

    document.getElementById('playBtn').onclick = () => {
        if(!audioCtx) initVisualizer();
        if(audio.paused) { audio.play(); playBtn.innerText = 'II'; }
        else { audio.pause(); playBtn.innerText = '‚ñ∂'; }
    };

    document.getElementById('volRange').oninput = (e) => {
        audio.volume = e.target.value;
        document.getElementById('volPerc').innerText = Math.round(e.target.value * 100) + "%";
    };

    setInterval(updateMetadata, 15000);
    updateMetadata();
</script>
</body>
</html>